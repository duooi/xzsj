<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .game {
            width: 560px;
            margin: 100px auto;
        }

        .game h2 {
            text-align: center;
        }

        canvas {
            border: 1px solid #ddd;
        }
    </style>
</head>

<body>
    <div class="game">
        <h2>Sokoban Game</h2>
        <canvas id="canvas" width="560" height="560"></canvas>
        <div class="op">
            <p>第<span class="level">1</span>/100关 移动次数: <span class="count">0</span></p>
            <div class="btn_group">
                <button onclick="nextLevel(-1)">上一关</button>
                <button onclick="nextLevel(1)">下一关</button>
                <button onclick="nextLevel(0)">重玩本关</button>
                <button onclick="showGameInfo()">游戏说明</button>
            </div>
        </div>
    </div>

    <script src="js/mapdata100.js"></script>
    <script>
        var canvas = document.querySelector("canvas");
        var ctx = canvas.getContext("2d");

        // 推箱子构造函数
        function Sokoban(ctx) {
            this.ctx = ctx || document.querySelector("canvas");
            // 当前关卡
            this.curLevel = 0;
            // 总关卡
            this.totalLevels = 100;

            this.init();
        }

        // 游戏初始化
        Sokoban.prototype.init = function () {
            // 初始化时先作资源预加载
            this.preload();

            // 按照map数组绘制相应元素
            this.drawMap();
        }

        // 绘制地图
        Sokoban.prototype.drawMap = function () {
            // 获取当前关卡地图
            var curMap = levels[this.curLevel];

            for (var i = 0; i < curMap.length; i++) {
                for (var j = 0; j < curMap[i].length; j++) {
                    // 根据类型绘制相应元素         
                    if (curMap[i][j] == 0) {
                        this.ctx.drawImage(this.block,)
                    } else if (curMap[i][j] == 1) {

                    } else if (curMap[i][j] == 2) {

                    } else if (curMap[i][j] == 3) {

                    } else if (curMap[i][j] == 4) {

                    }
                }
            }
        }

        Sokoban.prototype.drawEle = function (type) {

        }


        // 图片素材预加载
        Sokoban.prototype.preload = function () {
            var _this = this;
            // 素材资源
            var srcs = {
                "ball": "images/ball.png",
                "block": "images/block.gif",
                "box": "images/box.png",
                "pdown": "images/down.png",
                "pleft": "images/left.png",
                "pright": "images/right.png",
                "pup": "images/up.png",
                "wall": "images/wall.png"
            };

            // 资源加载完成后作为属性
            for (var src in srcs) {
                isFinished = false;
                var s = new Image();
                (function (src) {
                    s.onload = function () {
                        _this[src] = this;
                    };
                })(src);
                s.src = srcs[src];
            }
        }

        // 方向控制
        Sokoban.prototype.direct = function () { }

        // 推箱子
        Sokoban.prototype.pushBox = function () { }

        // 页面加载后自动创建推箱子游戏实例
        new Sokoban();
    </script>
</body>

</html>